{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Customize Your Cake</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(to right, #fff0f6, #ffe6f0);
            margin: 0;
            padding: 0;
        }

        header {
            background: linear-gradient(to right, #ff69b4, #ff85c1);
            color: white;
            text-align: center;
            padding: 50px 20px;
            border-bottom-left-radius: 50px;
            border-bottom-right-radius: 50px;
        }

        header h1 {
            font-size: 40px;
            font-weight: 700;
            margin: 0;
        }

        .container {
            max-width: 800px;
            margin: -40px auto 40px auto;
            background: #fff;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        label {
            font-weight: bold;
            margin-bottom: 5px;
        }

        input, select, textarea {
            border-radius: 12px;
            border: 1px solid #ddd;
            padding: 10px;
            transition: 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            border-color: #ff69b4;
            box-shadow: 0 0 5px rgba(255,105,180,0.3);
            outline: none;
        }

        .btn-submit {
            background: #ff69b4;
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
        }

        .btn-submit:hover {
            background: #ff85c1;
        }

        .reference-cake {
            text-align: center;
            margin-bottom: 30px;
        }

        .reference-cake img {
            max-width: 250px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .back-link {
            display: inline-block;
            margin-top: 20px;
            color: #ff69b4;
            text-decoration: none;
            font-weight: bold;
            transition: 0.3s;
        }

        .back-link:hover {
            text-decoration: underline;
            color: #ff3f9c;
        }

        .requests-card {
            margin-top: 40px;
        }

        .requests-card h4 {
            margin-bottom: 20px;
        }

        .card-request {
            background: #fff0f6;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }

        .card-request:hover {
            transform: translateY(-5px);
        }

        .card-request .badge {
            font-size: 14px;
            padding: 6px 10px;
        }

        table th, table td {
            vertical-align: middle !important;
        }
        .btn-outline-pink {
        color: #ff69b4;
        border: 2px solid #ff69b4;
        border-radius: 12px;
        padding: 10px 25px;
        font-weight: bold;
        transition: 0.3s;
        text-decoration: none;
        }

    .btn-outline-pink:hover {
        background-color: #ff69b4;
        color: white;
        text-decoration: none;
        }

    </style>
</head>
<body>

    <header>
        <h1>Customize Your Cake</h1>
    </header>

    <div class="container">

        {% if reference_cake %}
            <div class="reference-cake">
                <p>Based on:</p>
                <h3>{{ reference_cake.name }}</h3>
                {% if reference_cake.image %}
                    <img src="{{ reference_cake.image.url }}" alt="{{ reference_cake.name }}">
                {% endif %}
            </div>
        {% endif %}

        <form method="post">
            {% csrf_token %}
            <div class="mb-3">
                <label for="cake_name">Cake Name (optional):</label>
                <input type="text" id="cake_name" name="cake_name" class="form-control" placeholder="Custom Cake Name">
            </div>

            <div class="mb-3">
                <label for="flavor">Flavor:</label>
                <input type="text" id="flavor" name="flavor" class="form-control" placeholder="Chocolate, Vanilla, Red Velvet..." required>
            </div>

            <div class="mb-3">
                <label for="shape">Shape:</label>
                <select id="shape" name="shape" class="form-control" required>
                    <option value="">Select Shape</option>
                    <option value="Round">Round</option>
                    <option value="Square">Square</option>
                    <option value="Heart">Heart</option>
                    <option value="Rectangle">Rectangle</option>
                </select>
            </div>

            <div class="mb-3">
                <label for="size">Size:</label>
                <select id="size" name="size" class="form-control" required>
                    <option value="">Select Size</option>
                    <option value="Small">Small</option>
                    <option value="Medium">Medium</option>
                    <option value="Large">Large</option>
                </select>
            </div>

            <div class="mb-3">
                <label for="layers">Layers:</label>
                <select id="layers" name="layers" class="form-control" required>
                    <option value="">Select Layers</option>
                    <option value="1">1 Layer</option>
                    <option value="2">2 Layers</option>
                    <option value="3">3 Layers</option>
                    <option value="4">4 Layers</option>
                </select>
            </div>

            <div class="mb-3">
                <label for="weight">Weight (kg):</label>
                <input type="number" id="weight" name="weight" class="form-control" step="0.5" min="0.5" placeholder="e.g. 1.5" required>
            </div>

            <div class="mb-3">
                <label for="quantity">Quantity:</label>
                <input type="number" id="quantity" name="quantity" class="form-control" min="1" value="1" required>
            </div>

            <div class="mb-3">
                <label for="toppings">Toppings:</label>
                <input type="text" id="toppings" name="toppings" class="form-control" placeholder="E.g., Choco chips, Fruits, Nuts">
            </div>

            <div class="mb-3">
                <label for="message">Message on Cake:</label>
                <input type="text" id="message" name="message" class="form-control" placeholder="E.g., Happy Birthday!">
            </div>

            <div class="mb-3">
                <label for="details">Additional Instructions:</label>
                <textarea id="details" name="details" class="form-control" placeholder="Write any special instructions here..."></textarea>
            </div>

            <button type="submit" class="btn-submit">Submit Request</button>
        </form>

        {% if user_requests %}
            <div class="requests-card">
                <h4>Your Previous Requests</h4>
                {% for r in user_requests %}
                    <div class="card-request">
                        <strong>Cake:</strong> 
                        {% if r.cake_name %}{{ r.cake_name }}
                        {% elif r.reference_cake %}{{ r.reference_cake.name }}
                        {% else %}N/A{% endif %}<br>
                        <strong>Flavor:</strong> {{ r.flavor }} | 
                        <strong>Shape:</strong> {{ r.shape }} | 
                        <strong>Size:</strong> {{ r.size }} | 
                        <strong>Layers:</strong> {{ r.layers }} | 
                        <strong>Weight:</strong> {{ r.weight }} kg | 
                        <strong>Quantity:</strong> {{ r.quantity }}<br>
                        <span class="badge 
                            {% if r.status == 'Pending' %}bg-warning
                            {% elif r.status == 'Accepted' %}bg-success
                            {% elif r.status == 'Rejected' %}bg-danger
                            {% else %}bg-secondary{% endif %}">
                            {{ r.status }}
                        </span>
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        <div class="text-center mt-4">
            <a href="{% url 'user_home' %}" class="btn btn-outline-pink">
                &larr; Back to Cakes
            </a>
        </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
